This directory contains samples of each type of block page we know how
to detect.

The HTTP status-line and header are reconstructed from OONI reports and
are not fully representative of the original pages. For example, we do
not know the original response-phrase (e.g. "OK" or "Not Found") nor the
original header ordering.


== 403-CLOUDFLARE

The famous "Attention Required!" CloudFlare captcha.


== 403-GOOGLE-SORRY

The Google page "We're sorry... but your computer or network may be
sending automated queries." This one does not give you an opportunity to
solve a captcha.


== 403-IRAN

Block page used in Iran. There are two places where it may vary. The
first is in the title, which is of the form "M<digit>-<digit>". Looking
at 2462 samples from June 2015, I found this distribution of titles:

	$ grep -h -o '<title>.*' * | sed -e 's/^<title>//' | sort | uniq -c
	     78 M1-1
	     36 M1-2
	    101 M1-3
	     58 M1-4
	     35 M1-5
	     63 M1-6
	     51 M1-7
	     59 M1-8
	     61 M7-1
	     83 M7-2
	     77 M7-3
	     69 M7-4
	     77 M7-5
	     66 M7-6
	     67 M7-7
	     67 M7-8
	    192 M8-1
	    242 M8-2
	    195 M8-3
	    149 M8-4
	    187 M8-5
	    164 M8-6
	    172 M8-7
	    113 M8-8

The second place it may vary is in the source of the iframe. It may be
either of these:
	"http://10.10.34.34?type=Invalid Site&policy=MainPolicy "
	"http://10.10.34.34?type=Invalid Keyword&policy=MainPolicy "
It seems like the "Invalid Keyword" can only happen when the requested
URL has a query string.

Citizen Lab has a variation from 2014 with type="", rather than
type="Invalid Site" or type="Invalid Keyword"; also the source of the
referenced iframe:
https://github.com/citizenlab/blockpages/blob/master/html/ir.html
https://github.com/citizenlab/blockpages/blob/master/html/ir-iframe.html


== 403-AKAMAI, 404-AKAMAI

A block page with "Server: AkamaiGHost". It has the characteristic
Akamai "Reference&#32;&#35;" string. It can have HTTP status 403 or 404.


== 406-SITE5

It's the message "This request has been denied for security reasons. If
you believe this was in error, please contact support." The source of
the message is unclear, but evidence from web search indicates that it
comes from sites on a hosting company called Site5.
	http://forum.joomla.org/viewtopic.php?t=855169
	"This has very probably nothing to do with the problem, but...
	where are you hosted? I'm on a site5.com VPS in London that is
	due to be moved to a new location in a few days..."
	https://wordpress.stackexchange.com/questions/135275/new-wordpress-error-message-not-seen-this-before
	"If you're using site5 hosting, they block simple passwords i.e.
	'123'. Changing the password to something complicated fixed it."
	https://www.webhostingtalk.com/showthread.php?t=1466724
	"I just purchased a hosting plan with Site5 and I can't access
	my site. Also when I go on the Site5 site, I get.... 'This
	request has been denied for security reasons. If you believe
	this was in error, please contact support.'"
The message may come with a variety of Server header values, and may be
chunked or non-chunked.


== 503-CLOUDFLARE

These are block pages that run some kind of automated CloudFlare browser
test. There is distinctive CloudFlare markup, like
	<div class="cf-browser-verification cf-im-under-attack">
The HTML title is usually "Just a moment..." but the page can be
customized.


== 503-YELP

A custom block page of yelp.com. It contains the HTML
	<h2>Sorry, you're not allowed to access this page.</h2>
	<p>Your IP address is: X.X.X.X</p>
	<p>Please retry your request and <a href="mailto:feedback+unavailable@yelp.com?subject=IP%20Block%20Message%3A%20X.X.X.X">contact Yelp</a> if you continue experiencing issues.</p>
